<!DOCTYPE html>
<!-- This is the corresponding "starter code" for 07_Markers/Infowindows in Udacity and Google's Maps
API Course, Lesson 1 -->
<html>
 <head>

   <title>StarMap</title>

   <link rel='shortcut icon' type='image/icon' href='../static/favicon.ico' />

   <!-- Latest compiled and minified CSS -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

   <!-- Optional theme -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

   <!-- Google fonts -->
   <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200" rel="stylesheet">

 <!-- styles put here, but you can include a CSS file and reference it instead! -->
   <style type="text/css">
     html, body { height: 100%; margin: 0; padding: 0;}

     #main {
       width: 95%;
     }
     #title {
       text-align: center;
       font-family: sans-serif;;
       font-size: 55px;
       padding-bottom: 10px;
     }
     h1 {
       color: #434343;
     }
     #subtitle {
       text-align: center;
     }
     #map {
       height: 90%;
       width: 93%;
       margin-left: auto;
       margin-right: auto;
     }
     input[type=button] {
       border-radius:20px;
       border: none;
       width: 90px;
       height: 40px;
     }
     #options-box {
       padding-top: 7px;
       padding-bottom: 15px;
       margin-top: 15px;
     }
     #buttons-row {
       padding-bottom: 25px;
     }

     #inner {
      text-align: center;
     }

     #text {
       font-family: 'Source Sans Pro', sans-serif;
       font-size: 20px;
       font-weight: 200;
     }
     p {
       font-family: 'Source Sans Pro', sans-serif;
       font-size: 16px;
       font-weight: 200;
     }

     button {
       border-radius: 20px;
       border-color: black;
       background-color: white;
       width: 90px;
       height: 40px;
     }

     /* The Modal (background) */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content/Box */
    .modal-content {
        background-color: #fefefe;
        margin: 15% auto; /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%; /* Could be more or less, depending on screen size */
    }

    /* The Close Button */
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }
    #infoWindow {
      font-size: 16px;
    }

    @media screen and (min-width: 480px) {
    #infoWindow {
        font-size: 20px;
    }
}

   </style>
 </head>
 <!-- onload calls the function to display custom map markers upon the page being loaded -->
 <body onload="showListings()">
   <div id="main" class="container-fluid">
     <div class="row" id="options-box">
       <div class="col-xs-12">
         <p id="subtitle">Some stars are made...</p>
         <h1 id="title">Some are <b>born</b>.</h1>
         <p id="subtitle">have you ever wondered where stars come from?</p>
         <p id="subtitle">well stop wondering and look with your eyes</p>
       </div>
     </div>
     <div class="row" id="buttons-row">
       <div class="col-xs-4"></div>
       <div class="col-xs-4" id="inner">
         <input id="show" type="button" value="show all">
         <input id="hide" type="button" value="hide all">
         <!-- trigger/open the modal
         <input id="filterBtn" type="button" value="Filter">
         -->
         <button id="filterBtn">filter</button>
       </div>
       <div class="col-xs-4"></div>
    </div>
  </div>

   <!--the modal -->
   <div id="filterModal" class="modal">
     <!-- Modal content -->
     <div class="modal-content">
       <span class="close">&times;</span>
       <form id="modalForm">
         <input type="checkbox" checked name="musicians" value="musicians"><span id="text">&nbsp;&nbsp;&nbsp;musicians</span><br>
         <input type="checkbox" checked name="public figures" value="public figures"><span id="text">&nbsp;&nbsp;&nbsp;public figures</span><br>
         <input type="checkbox" checked name="athletes" value="athletes"><span id="text">&nbsp;&nbsp;&nbsp;athletes</span><br>
         <input type="checkbox" checked name="big screens" value="big screens"><span id="text">&nbsp;&nbsp;&nbsp;big screens</span><br>
         <input type="checkbox" checked name="bosses" value="bosses"><span id="text">&nbsp;&nbsp;&nbsp;bosses</span><br>
         <br>
         <input type="button" onclick="filterLocations()" value="enter">
       </form>
     </div>
   </div>

    <div id="map"></div>

   <script>
     var map;
     // Create a new blank array for all the listing markers.
     var markers = [];
     function initMap() {
       // Constructor creates a new map - only center and zoom are required.
       map = new google.maps.Map(document.getElementById('map'), {
         center: {lat: 37.8393, lng: -84.2700},
         zoom: 3,
         mapTypeControl: false,
         styles: [
            {
              "featureType": "administrative.neighborhood",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "road.highway",
              "elementType": "geometry.fill",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "road",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "featureType": "water",
              "elementType": "labels.text",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
         ]
       });
       // setting this so the map can't just zoom out forever
       map.setOptions({ minZoom: 3, maxZoom: 50 });

       // These are the real estate listings that will be shown to the user.
       // Normally we'd have these in a database instead.
       var locations = [
         {title: 'Beyonce', location: {lat: 29.7604, lng: -95.3698}, icon: 'http://imageshack.com/a/img924/3972/FWNstD.png', type: 'musicians', quote: '\"I\'m a human being\" - B'},
         {title: 'Barack Obama', location: {lat: 21.3069, lng: -157.8583}, icon: 'http://imageshack.com/a/img924/1223/ci0iYg.png', type: 'public figures', quote: '\"Just a Hawaii boy *wink*\" - BO'},
         {title: 'Justin Bieber', location: {lat: 42.9870, lng: -81.2432}, icon: 'http://imageshack.com/a/img924/6798/vWIELU.png', type: 'musicians', quote: '\"Haters are just confused admirers.\" - JB'},
         {title: 'Michelle Obama', location: {lat: 41.8781, lng: -87.6298}, icon: 'http://imageshack.com/a/img924/7969/trSAlA.png', type: 'public figures', quote: '\"So much history yet to be made.\" - MO'},
         {title: 'Lebron James', location: {lat: 41.0814, lng: -81.5190}, icon: 'http://imageshack.com/a/img923/6185/tf3EF5.png', type: 'athletes', quote: '\"I\'m still working out at my old high school.\" - LJ'},
         {title: 'Mark Zuckerberg', location: {lat: 41.0340, lng: -73.7629}, icon: 'http://imageshack.com/a/img923/7095/HAMELW.png', type: 'bosses', quote: '\"People love photos\" - MZ'},
         {title: 'Nelson Mandela', location: {lat: -31.9407, lng: 28.5492}, icon: 'http://imageshack.com/a/img921/3872/B41J07.png', type: 'public figures', quote: '\"It always seems impossible until it\'s done.\" - NM'},
         {title: 'Mindy Kaling', location: {lat: 42.3736, lng: -71.1097}, icon: 'http://imageshack.com/a/img922/7094/SvKwiq.png', type: 'big screens', quote: '\"Fast food is hugely important in the life of a comedy writer.\" - MK'},
         {title: 'Elon Musk', location: {lat: -25.7479, lng: 28.2293}, icon: 'http://imageshack.com/a/img922/2827/P14l9H.png', type: 'bosses', quote: '\"I would like to die on Mars.\" - EM'},
         {title: 'Adele', location: {lat: 51.6050, lng: -0.0723}, icon: 'http://imageshack.com/a/img924/9344/WJQPHs.png', type: 'musicians', quote: '\"Hello, it\'s me..\" - A'},
         {title: 'Ellen', location: {lat: 29.9841, lng: -90.1529}, icon: 'http://imageshack.com/a/img922/773/De4uHw.png', type: 'big screens', quote: '\"I still have the shirt I wore my first time on Johnny Carson\'s show.\" - E'},
         {title: 'Neymar', location: {lat: -23.5213, lng: -46.1859}, icon: 'http://imageshack.com/a/img923/603/3H6uHv.png', type: 'athletes', quote: '\"I was born to be happy not perfect.\" - N'},
         {title: 'Yao Ming', location: {lat: 31.2304, lng: 121.4737}, icon: 'http://imageshack.com/a/img923/3452/T3eRur.png', type: 'athletes', quote: '\"Friendship first, competition second.\" - YM'},
         {title: 'Malala', location: {lat: 34.7717, lng: 72.3602}, icon: 'http://imageshack.com/a/img921/5057/qg8KNb.png', type: 'public figures', quote: '\"All I want is an education, and I am afraid of no one.\" - M'}
       ];
       var largeInfowindow = new google.maps.InfoWindow();
       // The following group uses the location array to create an array of markers on initialize.
       for (var i = 0; i < locations.length; i++) {
         // Get the position from the location array.
         var position = locations[i].location;
         var title = locations[i].title;
         var icon = locations[i].icon;
         var type = locations[i].type;
         var quote = locations[i].quote;
         // Create a marker per location, and put into markers array.
          var marker = new google.maps.Marker({
           position: position,
           title: title,
           icon: icon,
           type: type,
           quote: quote,
           animation: google.maps.Animation.DROP,
           id: i
         });
         // Push the marker to our array of markers.
         markers.push(marker);
         // Create an onclick event to open an infowindow at each marker.
         marker.addListener('click', function() {
           populateInfoWindow(this, largeInfowindow);
         });
       }
       document.getElementById('show').addEventListener('click', showListings);
       document.getElementById('hide').addEventListener('click', hideListings);
     }
     // This function populates the infowindow when the marker is clicked. We'll only allow
     // one infowindow which will open at the marker that is clicked, and populate based
     // on that markers position.
     function populateInfoWindow(marker, infowindow) {
       // Check to make sure the infowindow is not already opened on this marker.
       if (infowindow.marker != marker) {
         infowindow.marker = marker;
         infowindow.setContent('<div id="infoWindow">' + marker.quote + '</div>');
         infowindow.open(map, marker);
         // Make sure the marker property is cleared if the infowindow is closed.
         infowindow.addListener('closeclick', function() {
           infowindow.marker = null;
         });
       }
     }
     // This function will loop through the markers array and display them all.
     function showListings() {
       var bounds = new google.maps.LatLngBounds();
       // Extend the boundaries of the map for each marker and display the marker
       for (var i = 0; i < markers.length; i++) {
         markers[i].setMap(map);
         //bounds.extend(markers[i].position);
       }
      // map.fitBounds(bounds);
     }
     // This function will loop through the listings and hide them all.
     function hideListings() {
       for (var i = 0; i < markers.length; i++) {
         markers[i].setMap(null);
       }
     }

  // THE MODAL

  // get the modal
  var modal = document.getElementById('filterModal');

  // get the button that opens the modal
  var btn = document.getElementById("filterBtn");

  // get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];

  // when the user clicks on the button, open the modal
  btn.onclick = function() {
    modal.style.display = "block";
  }

  // when the user clicks on <span> (x), close the modal
  span.onclick = function() {
    modal.style.display = "none";
  }

  // when the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }

  // MODAL LOGIC
  // shows marker if cooresponding checkbox is checked
  // hides marker otherwise
  function filterLocations() {
    var checkboxes = Array.from(modalForm); // HTMLElement
    markers = Array.from(markers); // GoogleMapsGarbageMarker

    var checkedCheckboxes = checkboxes.filter((checkbox) => checkbox.checked);

    var categoriesToShow = checkedCheckboxes.map(function(checkbox) {
      return checkbox.name;
    });

    var markersToDisplay = markers.filter((marker) => categoriesToShow.includes(marker.type));

    markers.forEach((marker) => marker.setMap(null));

    markersToDisplay.forEach(function(marker) {
      marker.setMap(map);
    });

    modal.style.display = "none";
  }

   </script>
   <script async defer
     src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyAiQUibtZZtp2HMDo3GcmfWxYS5E43QXU4&callback=initMap">
   </script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
 </body>
</html>
